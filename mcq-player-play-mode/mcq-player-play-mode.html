<link rel="import" href="../../polymer/polymer-element.html">
<link rel="import" href="showdown-import.html">
<link rel="import" href="jquery-import.html">
<link rel="import" href="../../paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../paper-card/paper-card.html">

<dom-module id="mcq-player-play-mode">
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900" rel="stylesheet">
  <template>
    <style>
      :host {
        width: 100%;
        height: 100%;
        display: block;
        background: white;
        font-family: 'Lato', sans-serif !important;
      }

      .play-card-element {
        height: 100%;
        width: 100%;
        display: flex;
        max-height: 100%;
        flex-direction: column;
        background: whitesmoke;
      }

      .card-content {
        font-size: 1.3em;
      }
      
      .option {
        display: inline-block;
        width: 428px;
        overflow-x: auto;
        max-width: 100%;
      }

      paper-toolbar.black {
        --paper-toolbar-background: black;
      }

      paper-radio-button {
        width: 100%;
        max-width: 100%;
        overflow: hidden;
        padding: 0px !important;
      }

      .card-content > h1 {
        font-weight:  lighter;
      }
    </style>
    <paper-card class="play-card-element">
      <div class="card-content">
        <h1>Question</h1>
        <div id="question"></div>
        <h1>Instructions</h1>
        <div id="instructions"></div>
        <h1>Options</h1>
        <paper-radio-group selected="{{selectedOption}}" id="options">   
        </paper-radio-group>
      </div>
    </paper-card>
  </template>

  <script>
    class McqPlayerPlayMode extends Polymer.Element {
      static get is() { return 'mcq-player-play-mode'; }
      static get properties() {
        return {
          assessmentItem: {
            type: Object,
            notify: true,
          },
          mdAssessmentItem: {
            type: String,
            observers: 'assessmentItemChanged',
            value: `# Question\nWhat is react\n# Instructions\nGo over there\n# Option-1\nThis is Option 1\n# Option 2\nThis is Option 2`
          },
          selectedOption: {
            type: String,
            notify: true,
            value: "2cc1ce38-0156-99b9-9a1e-63ff473cd12d",
          }
        };
      }

      static get observers() {
        return [
          'assessmentItemChanged(assessmentItem)'
        ]
      }

      constructor() {
        super();
        this.convertor = new showdown.Converter();
        this.options = [];  
      }

      connectedCallback() {
        super.connectedCallback();
      }

      assessmentItemChanged(assessmentItem) {
        jQuery(this.$.question).empty().append(assessmentItem.question.template);
        jQuery(this.$.instructions).empty().append(assessmentItem.instructions.template);
        jQuery(this.$.options).empty();
        for(let property in assessmentItem) {
          if (property !== 'question' && property !== 'instructions' && property !== 'answer') {
            const optionTemplate = `
            <paper-radio-button name='${assessmentItem[property].id}'>
              <div class="option">${assessmentItem[property].template}</div>
            </paper-radio-button>`;
            const optionElement = document.createElement('div');
            optionElement.innerHTML = optionTemplate;
            jQuery(this.$.options).append(optionTemplate)
          }
        }
      }
    }

    window.customElements.define(McqPlayerPlayMode.is, McqPlayerPlayMode);
  </script>
</dom-module>
